<!DOCTYPE html>
<html>
<head>
  <title>毕业100</title>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="css/index4.css">
  <style>
    .textarea{
      width: 100%;
      font-family:'幼圆';
      resize:none;
    }
  </style>
</head>
<body style="margin: 0">
  <div id="content">
    <div id="Home">   
      <div id="headimgdiv">
        <img id='headimg' src="img/4-1.png" style="width:100%">
      </div>
      <div id="name">
        <img src="img/4-1.png" style="width:100%">
      </div>
      <div id="name_txt">
        <textarea class="textarea" rows="1" id="name_text" readonly="readonly" style="font-size: 45px;background:transparent ;border-style:none;"></textarea>
      </div>
      <div id="major">
        <img src="img/4-2.png" style="width:100%">
      </div>
      <div id="major_txt">
        <textarea class="textarea" rows="1" id="major_text" readonly="readonly" style="font-size: 45px;background:transparent ;border-style:none;"></textarea>
      </div>
      <div id="love_building">
        <img src="img/4-3.png" style="width:100%">
      </div>
      <div id="building_txt">
        <textarea rows="1" class="textarea" id="building_text" readonly="readonly" style="font-size: 45px;background:transparent ;border-style:none;"></textarea>
      </div>
      <div id="love_food">
        <img src="img/4-4.png" style="width:100%">
      </div>
      <div id="food_txt">
        <textarea rows="1" class="textarea" id="food_text" readonly="readonly" style="font-size: 45px;background:transparent ;border-style:none;"></textarea>
      </div>     
      <div id="koudai">
        <img src="img/4-5.png" style="width:100%">
      </div>
      <div id="num">
        <textarea rows="1" class="textarea" id="num_text" readonly="readonly" style="font-size: 99px;background:transparent;border-style:none;"></textarea>
      </div>
      <div id="things">
        <img src="img/4-6.png" style="width:100%">
      </div>
      <div id="sodoi">
        <img src="img/4-7.png" style="width:100%">
      </div>
      <div id="square" style="display: none">
        <img id="squareimg" src="img/4-9.png" style="width:100%">
      </div>
      <!-- <div id="graduation">
        <img src="img/4-10.png" style="width:100%">
      </div> -->
    </div>
  </div>
    <div id='canvasdiv'>
        <canvas id="canvas" style="position: absolute;width:100%;left:0%;" ></canvas>
    </div>
</body>

 <script type="text/javascript">
    function onload(){
    var sen = "Home";  
    var width = document.documentElement.clientWidth;
    var height = document.documentElement.clientHeight;
    var ratio = width / height;
    if (ratio > (9 / 16)) {
      var bodywidth = height * 9 / 16;
      var margin = (width - bodywidth) / 2;
      document.getElementById(sen).style.height= height + 'px';
      document.getElementById(sen).style.width= bodywidth + 'px';
      document.getElementById(sen).style.marginLeft= margin + 'px';
      document.getElementById(sen).style.marginRight= margin + 'px';
    }else if(ratio < (9 / 16)){
      var bodyheight = width * 16 / 9;
      var margin = (height - bodyheight) / 2;
      document.getElementById(sen).style.height = bodyheight + 'px';
      document.getElementById(sen).style.width = width + 'px';
      document.getElementById(sen).style.marginTop = margin + 'px';
      document.getElementById(sen).style.marginBottom = margin + 'px';
    }else{
      document.getElementById(sen).style.height = height + 'px';
      document.getElementById(sen).style.width = width + 'px';
      document.getElementById(sen).style.marginTop = 0 + 'px';
      document.getElementById(sen).style.marginBottom = 0 + 'px';
    }
  }
  onload(); 
  getdata();
  function getdata(){

      var name = window.sessionStorage.getItem('name');
      var major = window.sessionStorage.getItem('major');
      var building = window.sessionStorage.getItem('build');
      var food = window.sessionStorage.getItem('food');
      var num = window.sessionStorage.getItem('num');
      var headimgsrc = window.sessionStorage.getItem('imgsrc');
      // console.log(headimgsrc)
      document.all.name_text.innerHTML = name;
      document.all.major_text.innerHTML = major;
      document.all.building_text.innerHTML = building;
      document.all.food_text.innerHTML = food;
      document.all.num_text.innerHTML = num;
      document.getElementById('headimg').src = headimgsrc
  }

  function getimglist(){//string序号数组转换int并返回
    var number = window.sessionStorage.getItem('number');
    var list = [];
    var arr = number.split(',');
      for(var i = 0;i < arr.length;i++){
          list[i] = parseInt(arr[i]);
      }
      return list;
  }
</script>
<script type="text/javascript">

var imgnumlist = getimglist();
var len = imgnumlist.length;
var he = Math.ceil(len/4);
var width = document.getElementById('canvasdiv').clientWidth;
var marginwidth = (1-0.76 * 0.96) * width / 2;
var marginheight = 0.01 * document.documentElement.clientHeight;
var backwidth = document.documentElement.clientWidth;
var height = document.getElementById('canvasdiv').clientHeight/3.8*he;

var can = document.getElementById('canvas');
var canvas = can.getContext('2d');
var backimg = document.getElementById("squareimg");
can.setAttribute('width',width)
can.setAttribute('height',height)
canvas.drawImage(backimg, 0 ,0,backwidth,height); 
 //int型选中的img序号数组
var imglist = [];
var p,q;
canvas.font = "18px bold 黑体";
canvas.textAlign = "center";
canvas.textBaseline = "middle";

for(var i = 0;i < imgnumlist.length; i++){
  n = imgnumlist[i];
  imglist.push({s:'事件'+n.toString(), x:0, y:0});
  imglist[i].picture = new Image();
  if(n + 1 < 10){
    imglist[i].picture.src = "img/100/0" + (n + 1).toString()+'.png';
  }
  else{
    imglist[i].picture.src = "img/100/" + (n + 1).toString()+'.png';
  }
}

var img = new Image();
var row,j;
img.src = "img/100/01.png";
img.onload=function(){ //将选出的图片排版
  if (len <= 4) {//直接一排
    for(var i = 0;i < len ; i++){
      canvas.drawImage(imglist[i].picture,marginwidth + 190*i,0+marginheight,img.width*0.17,img.height*0.17);    
    }
  }
  else{// 先将能排满的行排好
    _l = 4*Math.floor(len/4);
    if (len%4 == 0) row = 0; //row为0没有余数不单排
    else row = Math.ceil(len / 4) - 1;

    for(var i = 0,j = 0 ;j < _l ; i+=4){
      canvas.drawImage(imglist[j++].picture, marginwidth + 0 ,i*50+marginheight,img.width*0.17,img.height*0.17);    
      canvas.drawImage(imglist[j++].picture,marginwidth + 190,i*50+marginheight,img.width*0.17,img.height*0.17); 
      canvas.drawImage(imglist[j++].picture,marginwidth + 380,i*50+marginheight,img.width*0.17,img.height*0.17); 
      canvas.drawImage(imglist[j++].picture,marginwidth + 570,i*50+marginheight,img.width*0.17,img.height*0.17); 
    }
    if(row > 0){
      for(var i = 0; i < len-_l; i++){//余出来的单排
        canvas.drawImage(imglist[j++].picture,marginwidth + 190*i,row*200+marginheight,img.width*0.17,img.height*0.17);  
      }
    }  
  }
}

</script>
</html>
  